<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.54.0" />
  <meta name="author" content="Jason Preszler">
  <meta name="description" content="Assistant Professor - Math, Statistics, and Computer Science">

  
  <link rel="alternate" hreflang="en-us" href="/post/2018-10-01-norm-ridge/">

  
  


  

  
  
  
  
    
  
  
    
    
      
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
      
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
  
  <link rel="stylesheet" href="/styles.css">
  

  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-111748163-1', 'auto');
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Jason I. Preszler">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="Jason I. Preszler">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/2018-10-01-norm-ridge/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Jason I. Preszler">
  <meta property="og:url" content="/post/2018-10-01-norm-ridge/">
  <meta property="og:title" content="Ridges of Normality | Jason I. Preszler">
  <meta property="og:description" content="">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2018-10-03T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2018-10-03T00:00:00&#43;00:00">
  

  

  <title>Ridges of Normality | Jason I. Preszler</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" >

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/">Jason I. Preszler</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-right">
        

        

        
          
        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#publications">
            
            <span>Publications</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#talks">
            
            <span>Talks</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <div class="article-inner">
      <h1 itemprop="name">Ridges of Normality</h1>

      

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2018-10-03 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Oct 3, 2018
    </time>
  </span>

  

  
  

  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Ridges%20of%20Normality&amp;url=%2fpost%2f2018-10-01-norm-ridge%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2f2018-10-01-norm-ridge%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2f2018-10-01-norm-ridge%2f&amp;title=Ridges%20of%20Normality"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2f2018-10-01-norm-ridge%2f&amp;title=Ridges%20of%20Normality"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Ridges%20of%20Normality&amp;body=%2fpost%2f2018-10-01-norm-ridge%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


      <div class="article-style" itemprop="articleBody">
        


<p>One of the classic assumptions of the linear regression models is that, conditioned on the explanatory variables, the response variable should be normally distributed. While teaching this the other day, I had a flash of insight into how to visualize this - ridge-line plots!</p>
<div id="data" class="section level2">
<h2>Data</h2>
<p>I’ve been using Matloff’s <em>Statistical Regression and Classification</em> book, which uses the <code>mlb</code> dataset from his <code>freqparcoord</code> package. This has data on heights, weights, ages, positions, and teams of over 1000 major league baseball players. We’ll focus on just height and weight for now. Let’s load the packages we’ll need and the data and look at a simple scatter plot.</p>
<pre class="r"><code>library(freqparcoord)
library(dplyr)
library(purrr)
library(ggplot2)
library(ggridges)
data(mlb)

ggplot(mlb, aes(x=Height, y=Weight))+
  geom_point(alpha=.2)+
  ggtitle(&quot;Heights and Weights of MLB Players&quot;)</code></pre>
<p><img src="/post/2018-10-01-norm-ridge_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Because height is only measured to the inch, the data is naturally “grouped” which helps see the conditioning we’ll need.</p>
</div>
<div id="first-try-at-normality" class="section level2">
<h2>First Try at Normality</h2>
<p>The first thing I tried in class was to use a side-by-side boxplot that we had constructed earlier in the semester. This uses a familiar visualization to see the distribution of weights for each height - but even symmetric boxplots don’t ensure normality. Here’s the graph:</p>
<pre class="r"><code>ggplot(mlb, aes(x=Height, y=Weight, group=Height))+
  geom_boxplot()+
  ggtitle(&quot;Boxplots of Weights for each Height of MLB Player&quot;)</code></pre>
<p><img src="/post/2018-10-01-norm-ridge_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="second-try-at-normality" class="section level2">
<h2>Second Try at Normality</h2>
<p>While we were discussing the normality (or lack of it) in the boxplots, I thought about using a ridge-line plot so I brought this up in class:</p>
<pre class="r"><code>ggplot(mlb, aes(y=Height, x=Weight, group=Height))+
  geom_density_ridges()+
  ggtitle(&quot;Ridgeline Plot of MLB Players Weights for each Height&quot;)</code></pre>
<p><img src="/post/2018-10-01-norm-ridge_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>This has the advantage of showing the sample distribution. Few if any of my students had seen such a plot, but seemed to understand what it was showing. I remarked that these seemed pretty normal, for real sample data, right at the end of class and at least one student looked concerned about that.</p>
</div>
<div id="comparing-with-a-normal-sample" class="section level2">
<h2>Comparing with a Normal Sample</h2>
<p>To show how normal the data is, I decided to generate sample normal data (via <code>rnorm</code>) with the same mean and standard deviation of weights for each height. First, let’s build the dataframe of conditional means and standard deviations (homoscedasticity is another issue):</p>
<pre class="r"><code>mlbNormP &lt;- group_by(mlb, Height) %&gt;% 
  summarise(mean=mean(Weight), sd = sd(Weight), n=n()) %&gt;%
  filter(n&gt;4)

knitr::kable(head(mlbNormP))</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">Height</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">68</td>
<td align="right">173.8571</td>
<td align="right">22.08641</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="right">69</td>
<td align="right">179.9474</td>
<td align="right">15.32055</td>
<td align="right">19</td>
</tr>
<tr class="odd">
<td align="right">70</td>
<td align="right">183.0980</td>
<td align="right">13.54143</td>
<td align="right">51</td>
</tr>
<tr class="even">
<td align="right">71</td>
<td align="right">190.3596</td>
<td align="right">16.43461</td>
<td align="right">89</td>
</tr>
<tr class="odd">
<td align="right">72</td>
<td align="right">192.5600</td>
<td align="right">17.56349</td>
<td align="right">150</td>
</tr>
<tr class="even">
<td align="right">73</td>
<td align="right">196.7716</td>
<td align="right">16.41249</td>
<td align="right">162</td>
</tr>
</tbody>
</table>
<p>I’ve filtered out heights with less than 4 players, mainly for aesthetic purposes. Now for each row of this dataframe, we want to generate a random sample of normally distributed data. This is where <code>purrr::pmap_dfr</code> comes in - which will <code>map</code> (tidyverse version of <code>apply</code>) a function onto a list of input vectors in parallel and bind the results into a dataframe along rows.</p>
<pre class="r"><code>mlbNorm&lt;-pmap_dfr(
  list(
    x=mlbNormP$Height, y=mlbNormP$mean, 
    z=mlbNormP$sd, w = mlbNormP$n),
  function(x,y,z,w){
    data.frame(Ht=rep(x,100), WtNorm=rnorm(100, y, z))
    }) </code></pre>
<p>Here I’m not using the size of our sample of each height, instead using 100 for each height. Now let’s plot both ridge-lines, and color based on the observed (blue) or generated (red) data.</p>
<pre class="r"><code>ggplot()+
  geom_density_ridges(data=mlbNorm, 
                      aes(y=Ht, x=WtNorm, group=Ht), fill=&quot;red&quot;, alpha=.3) + 
  geom_density_ridges(data=mlb, 
                      aes(x=Weight, y=Height, group=Height), 
                      fill=&quot;blue&quot;, alpha=.3)</code></pre>
<p><img src="/post/2018-10-01-norm-ridge_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Alternatively, we can take advantage of the size of each sample of observed data:</p>
<pre class="r"><code>mlbNorm2&lt;-pmap_dfr(
  list(
    x=mlbNormP$Height, y=mlbNormP$mean, 
    z=mlbNormP$sd, w = mlbNormP$n),
  function(x,y,z,w){
    data.frame(Ht=rep(x,w), WtNorm=rnorm(w, y, z))
    }) 

ggplot()+
  geom_density_ridges(data=mlbNorm2, 
                      aes(y=Ht, x=WtNorm, group=Ht), fill=&quot;red&quot;, alpha=.3) + 
  geom_density_ridges(data=mlb, 
                      aes(x=Weight, y=Height, group=Height), 
                      fill=&quot;blue&quot;, alpha=.3)</code></pre>
<p><img src="/post/2018-10-01-norm-ridge_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>In either case, the generated random normal data is very similar to the actual data in our dataset. This also seems to provide a nice, general method to visualize if this assumption of our linear model is violated by the data.</p>
</div>

      </div>

      


<div class="article-tags">
  
  <a class="btn btn-primary btn-outline" href="/tags/r">R</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/ggplot">ggplot</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/purrr">purrr</a>
  
</div>



    </div>
  </div>

</article>



<div class="article-container article-widget">
  <div class="hr-light"></div>
  <h3>Related</h3>
  <ul>
    
    <li><a href="/post/2018-3-11-run-tacoma1/">Running Tacoma: Maps</a></li>
    
    <li><a href="/post/2018-01-27-acs-map/">Idaho ACS Mapping</a></li>
    
    <li><a href="/post/2018-01-15-stock-rw/">Stock Random Walks</a></li>
    
    <li><a href="/post/2018-08-21-chords/">What a Tangled Web We Weave...</a></li>
    
    <li><a href="/post/2018-07-30-top_n/">Lesser Known Verbs: top_n</a></li>
    
  </ul>
</div>




<div class="article-container">
  

</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2017 Jason Preszler &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/c.min.js"></script>
      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    
    

  </body>
</html>

